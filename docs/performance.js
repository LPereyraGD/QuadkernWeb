class e{constructor(){this.observers=new Map,this.config={enableLazyLoading:!0,enableImageOptimization:!0,enableResourcePreloading:!0,enableAnalytics:!0,maxParticles:this.getOptimalParticleCount(),reducedMotion:this.prefersReducedMotion()},this.metrics={loadTime:0,renderTime:0,interactionTime:0,memoryUsage:0},this.initPrivate()}async init(){this.measureLoadTime(),this.setupLazyLoading(),this.setupImageOptimization(),this.setupResourcePreloading(),this.setupPerformanceMonitoring(),this.optimizeForGitHubPages()}initPrivate(){this.measureLoadTime(),this.setupLazyLoading(),this.setupImageOptimization(),this.setupResourcePreloading(),this.setupPerformanceMonitoring(),this.optimizeForGitHubPages()}getOptimalParticleCount(){const e=navigator.hardwareConcurrency||4,t=navigator.deviceMemory||4,i=/Mobi|Android/i.test(navigator.userAgent),o=4>t||4>e;return window.matchMedia("(prefers-reduced-motion: reduce)").matches?5:i||o?Math.min(15,2*e):8>t||6>e?4>t||4>e?20:30:50}prefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}measureLoadTime(){const e=performance.now();window.addEventListener("load",()=>{this.metrics.loadTime=performance.now()-e,this.reportMetrics()})}setupLazyLoading(){if(!this.config.enableLazyLoading)return;const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const i=t.target;i.dataset.src&&(i.src=i.dataset.src,i.classList.add("loaded"),e.unobserve(i))}})});document.querySelectorAll("img[data-src]").forEach(t=>{e.observe(t)}),this.observers.set("images",e)}setupImageOptimization(){this.config.enableImageOptimization&&document.querySelectorAll("img").forEach(e=>{e.hasAttribute("loading")||e.setAttribute("loading","lazy"),(window.devicePixelRatio||1)>1&&(e.style.imageRendering="crisp-edges")})}setupResourcePreloading(){this.config.enableResourcePreloading&&["./QuadkernLogo.png","https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Space+Grotesk:wght@400;500;700"].forEach(e=>{const t=document.createElement("link");t.rel="preload",t.href=e,e.includes(".png")?t.as="image":e.includes("fonts.googleapis.com")&&(t.as="style"),document.head.appendChild(t)})}setupPerformanceMonitoring(){let e=0,t=performance.now(),i=0;const o=()=>{e++;const n=performance.now();if(n-t>=1e3){const o=Math.round(1e3*e/(n-t));30>o?(i++,this.reduceEffects(),3>i||(this.enableAggressiveOptimizations(),i=0)):o>50?(i=0,this.enhanceEffects()):i=Math.max(0,i-1),e=0,t=n}requestAnimationFrame(o)};requestAnimationFrame(o)}reduceEffects(){const e=window.quadkernEffects;e&&(e.setIntensity(.5),e.setSpeed(.7))}enhanceEffects(){const e=window.quadkernEffects;e&&(e.setIntensity(1),e.setSpeed(1))}enableAggressiveOptimizations(){const e=window.quadkernEffects;e&&(e.setIntensity(.3),e.setSpeed(.5)),this.config.maxParticles=Math.max(5,Math.floor(.5*this.config.maxParticles)),this.config.enableLazyLoading=!1,this.config.enableResourcePreloading=!1,document.documentElement.style.setProperty("--animation-duration","0.1s"),document.documentElement.style.setProperty("--transition-duration","0.1s")}optimizeForGitHubPages(){this.setupResourceCompression(),this.setupLocalStorageCache(),this.optimizeForCDN(),this.handleSlowConnections()}setupResourceCompression(){window.quadkernCompress={compress:e=>btoa(encodeURIComponent(e)),decompress:e=>decodeURIComponent(atob(e))}}setupLocalStorageCache(){const e="quadkern-cache",t="1.0.0",i=localStorage.getItem(e);if(i)try{if(JSON.parse(i).version===t)return}catch(t){localStorage.removeItem(e)}const o={version:t,timestamp:Date.now(),resources:{}};localStorage.setItem(e,JSON.stringify(o))}optimizeForCDN(){document.querySelectorAll('link[href^="http"]').forEach(e=>{e.setAttribute("crossorigin","anonymous")})}handleSlowConnections(){const e=navigator.connection;e&&("slow-2g"===e.effectiveType||"2g"===e.effectiveType||e.saveData)&&this.enableLowBandwidthMode()}enableLowBandwidthMode(){const e=window.quadkernEffects;e&&(e.setIntensity(.3),e.setSpeed(.5)),document.querySelectorAll("img").forEach(e=>{e.style.imageRendering="pixelated"})}reportMetrics(){this.config.enableAnalytics}getMetrics(){return{...this.metrics}}enableLowPowerMode(){this.config.maxParticles=Math.floor(this.config.maxParticles/2),this.config.reducedMotion=!0;const e=window.quadkernEffects;e&&(e.setIntensity(.4),e.setSpeed(.6))}enableHighPerformanceMode(){this.config.maxParticles=1.5*this.getOptimalParticleCount(),this.config.reducedMotion=!1;const e=window.quadkernEffects;e&&(e.setIntensity(1.2),e.setSpeed(1.3))}}document.addEventListener("DOMContentLoaded",()=>{const t=new e;window.quadkernPerformance=t});export{e as QuadKernPerformance};